<!DOCTYPE html>
<html lang="it">
<head>
    <!-- PWA meta e asset -->
    <meta name="theme-color" content="#4A90E2">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="MetOp Lab">
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="manifest" href="/metodologieoperative/manifest.json">
    <link rel="apple-touch-icon" sizes="72x72" href="/metodologieoperative/icons/icon-72x72.png">
    <link rel="apple-touch-icon" sizes="96x96" href="/metodologieoperative/icons/icon-96x96.png">
    <link rel="apple-touch-icon" sizes="128x128" href="/metodologieoperative/icons/icon-128x128.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/metodologieoperative/icons/icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/metodologieoperative/icons/icon-152x152.png">
    <link rel="apple-touch-icon" sizes="192x192" href="/metodologieoperative/icons/icon-192x192.png">
    <link rel="apple-touch-icon" sizes="384x384" href="/metodologieoperative/icons/icon-384x384.png">
    <link rel="apple-touch-icon" sizes="512x512" href="/metodologieoperative/icons/icon-512x512.png">
    <link rel="apple-touch-startup-image" href="/metodologieoperative/icons/icon-512x512.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/metodologieoperative/icons/icon-72x72.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/metodologieoperative/icons/icon-72x72.png">
    <meta name="page-id" content="attivita-index-01">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Materiali Didattici - Metodologie Operative</title>
    <meta name="description" content="Materiali didattici per Metodologie Operative - Servizi Sociosanitari - IIS Meucci Mattei Cagliari">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <div class="container">
            <h1>Materiali Didattici - Metodologie Operative</h1>
            <p>Servizi per la Sanit√† e l'Assistenza Sociale</p>
            <p style="font-size: 0.9rem; margin-top: 0.5rem;">IIS Meucci Mattei - Cagliari (Sede Decimomannu)</p>
        </div>
    </header>

    <nav>
        <ul>
            <li><a href="index.html" class="active">Home</a></li>
            <li><a href="biennio.html">Biennio</a></li>
            <li><a href="terzo.html">Terzo Anno</a></li>
            <li><a href="quarto.html">Quarto Anno</a></li>
            <li><a href="quinto.html">Quinto Anno</a></li>
            <li><a href="laboratorio.html">Laboratorio</a></li>
            <li><a href="peer_tutoring.html">Peer Tutoring</a></li>
            <li><a href="compresenza.html">Compresenza Scienze Umane</a></li>
            <li class="nav-ai"><a href="index.html#intelligenza-artificiale">Spazio AI</a></li>
        </ul>
    </nav>

    <main>
        <div class="container">
            <div class="intro">
                <h2>Benvenuti</h2>
                <p>Questa piattaforma contiene tutti i materiali didattici per il corso di <strong>Metodologie Operative</strong> dell'indirizzo <strong>Servizi per la Sanit√† e l'Assistenza Sociale</strong>.</p>
                <p>I materiali sono organizzati per anno scolastico e vengono aggiornati regolarmente durante l'anno.</p>
                <p style="margin-top: 1rem;">Seleziona il tuo anno di corso per accedere ai materiali:</p>
            </div>

            <div class="cards">
                <a href="biennio.html" class="card">
                    <h3>üìö Biennio</h3>
                    <p>Materiali per il primo e secondo anno</p>
                    <p style="color: #3498db; margin-top: 1rem;">Accedi ai materiali ‚Üí</p>
                </a>

                <a href="terzo.html" class="card">
                    <h3>üìñ Terzo Anno</h3>
                    <p>Materiali per il terzo anno</p>
                    <p style="color: #3498db; margin-top: 1rem;">Accedi ai materiali ‚Üí</p>
                </a>

                <a href="quarto.html" class="card">
                    <h3>üìù Quarto Anno</h3>
                    <p>Materiali per il quarto anno</p>
                    <p style="color: #3498db; margin-top: 1rem;">Accedi ai materiali ‚Üí</p>
                </a>

                <a href="quinto.html" class="card">
                    <h3>üéì Quinto Anno</h3>
                    <p>Materiali per il quinto anno</p>
                    <p style="color: #3498db; margin-top: 1rem;">Accedi ai materiali ‚Üí</p>
                </a>

                <a href="laboratorio.html" class="card">
                    <h3>üß™ Laboratorio</h3>
                    <p>Percorsi esperienziali pronti per la classe</p>
                    <p style="color: #3498db; margin-top: 1rem;">Apri la sezione ‚Üí</p>
                </a>

                <a href="compresenza.html" class="card">
                    <h3>ü§ù Compresenza Scienze Umane</h3>
                    <p>Attivit√† interdisciplinari Scienze Umane e Metodologie Operative</p>
                    <p style="color: #3498db; margin-top: 1rem;">Accedi ai materiali ‚Üí</p>
                </a>

                <a href="peer_tutoring.html" class="card">
                    <h3>ü§ù Peer Tutoring</h3>
                    <p>Dashboard con attivit√† interattive e materiali dedicati</p>
                    <p style="color: #3498db; margin-top: 1rem;">Accedi ai materiali ‚Üí</p>
                </a>

                <a href="#intelligenza-artificiale" class="card">
                    <h3>ü§ñ Intelligenza Artificiale</h3>
                    <p>Risorse dedicate all'AI per le Metodologie Operative</p>
                    <p style="color: #3498db; margin-top: 1rem;">Esplora la sezione ‚Üí</p>
                </a>

                <a href="area_docente.html" class="card">
                    <h3>üõ°Ô∏è Area Docente</h3>
                    <p>Monitora i progressi delle classi, i salvataggi e le attivit√† assegnate.</p>
                    <p style="color: #3498db; margin-top: 1rem;">Apri la dashboard ‚Üí</p>
                </a>
            </div>

            <section id="intelligenza-artificiale" class="ai-section">
                <div class="intro">
                    <h2>Spazio Intelligenza Artificiale</h2>
                    <p>In questa sezione raccoglieremo materiali aggiornati per comprendere, valutare e utilizzare in modo consapevole l'intelligenza artificiale nei servizi sociosanitari.</p>
                    <p>Troverai sia materiali da scaricare (linee guida, schede operative, casi studio) sia attivit√† interattive in formato HTML da aprire direttamente dal sito per sperimentare nuove strategie didattiche.</p>
                </div>

                <div id="materiali-ai">
                    <div class="loading">Caricamento materiali in corso...</div>
                </div>
            </section>

            <div class="intro" style="margin-top: 2rem;">
                <h2>Come utilizzare questa piattaforma</h2>
                <p><strong>1.</strong> Seleziona il tuo anno di corso dal menu di navigazione o dalle card qui sopra</p>
                <p><strong>2.</strong> Visualizza l'elenco dei materiali disponibili</p>
                <p><strong>3.</strong> Clicca sul pulsante "Scarica" per accedere al materiale</p>
                <p style="margin-top: 1rem; color: #7f8c8d; font-style: italic;">I materiali vengono aggiornati regolarmente. Controlla periodicamente la presenza di nuovi contenuti.</p>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <p><strong>Prof. Dott. Picconi</strong></p>
            <p>Metodologie Operative - Servizi Sociosanitari</p>
            <p>IIS Meucci Mattei - Cagliari</p>
            <p style="margin-top: 1rem; font-size: 0.9rem;">&copy; 2025 - Tutti i diritti riservati</p>
            <div class="home-link">
                <a href="https://salvapicconi.github.io/metodologieoperative/">üè† Torna alla Home</a>
            </div>
        </div>
    </footer>
    <script src="materiali.js"></script>
    <script>
        window.MO_PROGRESS_CONFIG = {
            disabled: true,
            pathPrefixes: ['/metodologieoperative']
        };
    </script>
    <script>
        window.MO_IDENTITY_CONFIG = {
            message: 'Inserisci la classe (es. 3sa) e il codice cognome+iniziale tutto minuscolo (es. rossi g ‚Üí rossig).',
            classPlaceholder: 'Classe (es. 3sa)',
            classPattern: '^[1-5][a-z]{1,2}$',
            classExample: '3sa',
            classErrorMessage: 'Classe non valida: usa una cifra da 1 a 5 seguita da 1-2 lettere minuscole (es. 3sa).',
            stripWhitespaceInClass: true,
            storeClassLowercase: true,
            storeClassUppercase: false,
            codePlaceholder: 'Codice (es. rossig)',
            codePattern: '^[a-z√†-√º]{2,}[a-z]$',
            codeExample: 'rossig',
            codeErrorMessage: 'Codice non valido: usa cognome tutto minuscolo + iniziale del nome (es. rossi g ‚Üí rossig).',
            sanitizeCode: true,
            stripWhitespaceInCode: true,
            storeCodeLowercase: true,
            storeCodeUppercase: false,
            hideGenerator: true,
            guestAllowed: true,
            guestClassCode: 'ospite',
            guestStudentCode: 'ospite'
        };
    </script>

    <script type="module" src="assets/progress.js"></script>
    <script type="module" src="assets/progress-global.js"></script>
<script>
// ============================================
// PWA - Registrazione Service Worker
// ============================================

if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('/metodologieoperative/service-worker.js')
      .then(registration => {
        console.log('‚úÖ Service Worker registrato con successo:', registration.scope);
        
        // Verifica aggiornamenti
        registration.addEventListener('updatefound', () => {
          const newWorker = registration.installing;
          console.log('üîÑ Nuovo Service Worker in installazione...');
          
          newWorker.addEventListener('statechange', () => {
            if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
              // Mostra notifica di aggiornamento disponibile
              mostrarNotificaAggiornamento();
            }
          });
        });
      })
      .catch(error => {
        console.error('‚ùå Errore registrazione Service Worker:', error);
      });
  });
}

// ============================================
// PWA - Prompt Installazione
// ============================================

let deferredPrompt;
let installPromptAvailable = false;
let installHintTimeout;
const installButton = document.createElement('button');
installButton.id = 'pwa-install-button';
installButton.innerHTML = 'üì± Installa App';
installButton.style.cssText = `
  position: fixed;
  bottom: 20px;
  right: 20px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border: none;
  padding: 15px 25px;
  border-radius: 30px;
  font-size: 16px;
  font-weight: bold;
  cursor: pointer;
  box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
  z-index: 10000;
  display: block;
  transition: all 0.3s ease;
  opacity: 0.95;
`;
installButton.title = 'Installa l\'app sul tuo dispositivo';
installButton.setAttribute('aria-live', 'polite');
installButton.setAttribute('data-ready', 'false');

installButton.addEventListener('mouseenter', () => {
  installButton.style.transform = 'translateY(-2px)';
  installButton.style.boxShadow = '0 6px 20px rgba(102, 126, 234, 0.6)';
});

installButton.addEventListener('mouseleave', () => {
  installButton.style.transform = 'translateY(0)';
  installButton.style.boxShadow = '0 4px 15px rgba(102, 126, 234, 0.4)';
});

document.body.appendChild(installButton);
setTimeout(() => {
  if (!installPromptAvailable) {
    mostraIstruzioniInstallazioneManuale();
  }
}, 4000);

function mostraIstruzioniInstallazioneManuale() {
  rimuoviIstruzioniInstallazioneManuale();
  const hint = document.createElement('div');
  hint.id = 'pwa-install-hint';
  hint.innerHTML = `
    <strong>Come installare l'app:</strong><br>
    ‚Ä¢ Android: menu ‚ãÆ ‚Üí \"Aggiungi a schermata Home\".<br>
    ‚Ä¢ iPhone/iPad: icona Condividi ‚Üí \"Aggiungi alla schermata Home\".
  `;
  hint.style.cssText = `
    position: fixed;
    bottom: 100px;
    right: 20px;
    background: rgba(0, 0, 0, 0.85);
    color: #fff;
    padding: 12px 16px;
    border-radius: 12px;
    font-size: 14px;
    line-height: 1.4;
    z-index: 9999;
    max-width: 260px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
  `;
  document.body.appendChild(hint);
  installHintTimeout = setTimeout(() => {
    rimuoviIstruzioniInstallazioneManuale();
  }, 7000);
}

function rimuoviIstruzioniInstallazioneManuale() {
  if (installHintTimeout) {
    clearTimeout(installHintTimeout);
    installHintTimeout = null;
  }
  const existingHint = document.getElementById('pwa-install-hint');
  if (existingHint) {
    existingHint.remove();
  }
}

window.addEventListener('beforeinstallprompt', (e) => {
  // Previeni il prompt automatico
  e.preventDefault();
  deferredPrompt = e;
  installPromptAvailable = true;
  installButton.setAttribute('data-ready', 'true');
  installButton.innerHTML = 'üì± Installa App';
  installButton.title = 'Tocca per installare l\'app';
  rimuoviIstruzioniInstallazioneManuale();
  
  console.log('üí° Prompt installazione PWA disponibile');
});

installButton.addEventListener('click', async () => {
  if (!deferredPrompt) {
    mostraIstruzioniInstallazioneManuale();
    return;
  }
  
  // Mostra il prompt di installazione
  deferredPrompt.prompt();
  
  // Aspetta la scelta dell'utente
  const { outcome } = await deferredPrompt.userChoice;
  
  console.log(`üë§ Scelta utente: ${outcome}`);
  
  if (outcome === 'accepted') {
    console.log('‚úÖ Utente ha accettato l\'installazione');
    
    // Mostra messaggio di conferma
    const toast = document.createElement('div');
    toast.innerHTML = 'üéâ App installata con successo!';
    toast.style.cssText = `
      position: fixed;
      top: 20px;
      right: 20px;
      background: #28a745;
      color: white;
      padding: 15px 25px;
      border-radius: 10px;
      box-shadow: 0 4px 15px rgba(40, 167, 69, 0.4);
      z-index: 10001;
      animation: slideIn 0.3s ease;
    `;
    document.body.appendChild(toast);
    
    setTimeout(() => {
      toast.style.animation = 'slideOut 0.3s ease';
      setTimeout(() => toast.remove(), 300);
    }, 3000);
  } else {
    console.log('‚ùå Utente ha rifiutato l\'installazione');
    mostraIstruzioniInstallazioneManuale();
  }
  
  if (outcome === 'accepted') {
    installButton.style.display = 'none';
  }
  deferredPrompt = null;
});

// Nascondi bottone dopo installazione
window.addEventListener('appinstalled', () => {
  console.log('‚úÖ PWA installata con successo');
  installButton.style.display = 'none';
  deferredPrompt = null;
  
  // Salva stato installazione
  localStorage.setItem('pwaInstalled', 'true');
});

// ============================================
// PWA - Notifiche Push (opzionale)
// ============================================

async function richiediPermessoNotifiche() {
  if (!('Notification' in window)) {
    console.log('‚ùå Browser non supporta notifiche');
    return;
  }
  
  if (Notification.permission === 'granted') {
    console.log('‚úÖ Permesso notifiche gi√† concesso');
    return;
  }
  
  if (Notification.permission !== 'denied') {
    const permission = await Notification.requestPermission();
    
    if (permission === 'granted') {
      console.log('‚úÖ Permesso notifiche concesso');
      
      // Mostra notifica di benvenuto
      new Notification('Metodologie Operative Lab', {
        body: 'Notifiche attivate! Ti avviseremo quando ci sono nuovi contenuti.',
        icon: '/metodologieoperative/icons/icon-192x192.png',
        badge: '/metodologieoperative/icons/icon-72x72.png'
      });
    }
  }
}

// Richiedi permesso dopo 30 secondi (non invasivo)
if (localStorage.getItem('pwaInstalled') === 'true') {
  setTimeout(richiediPermessoNotifiche, 30000);
}

// ============================================
// PWA - Gestione Aggiornamenti
// ============================================

function mostrarNotificaAggiornamento() {
  const updateToast = document.createElement('div');
  updateToast.innerHTML = `
    <div style="display: flex; align-items: center; gap: 10px;">
      <span>üîÑ Nuova versione disponibile!</span>
      <button id="update-reload-btn" style="
        background: white;
        color: #667eea;
        border: none;
        padding: 8px 15px;
        border-radius: 5px;
        font-weight: bold;
        cursor: pointer;
      ">Aggiorna</button>
    </div>
  `;
  updateToast.style.cssText = `
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: #667eea;
    color: white;
    padding: 15px 25px;
    border-radius: 10px;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    z-index: 10001;
    animation: slideDown 0.3s ease;
  `;
  
  document.body.appendChild(updateToast);
  
  document.getElementById('update-reload-btn').addEventListener('click', () => {
    // Invia messaggio al Service Worker per attivarsi
    navigator.serviceWorker.controller.postMessage({ action: 'skipWaiting' });
    
    // Ricarica la pagina
    window.location.reload();
  });
}

// ============================================
// PWA - Stato Connessione
// ============================================

function aggiornaStatoConnessione() {
  if (!navigator.onLine) {
    const offlineToast = document.createElement('div');
    offlineToast.innerHTML = 'üì° Modalit√† Offline - Contenuti salvati disponibili';
    offlineToast.style.cssText = `
      position: fixed;
      bottom: 80px;
      left: 50%;
      transform: translateX(-50%);
      background: #ffc107;
      color: #333;
      padding: 12px 20px;
      border-radius: 10px;
      box-shadow: 0 4px 15px rgba(255, 193, 7, 0.4);
      z-index: 9999;
      animation: slideUp 0.3s ease;
      font-weight: bold;
    `;
    
    offlineToast.id = 'offline-toast';
    document.body.appendChild(offlineToast);
  } else {
    const existingToast = document.getElementById('offline-toast');
    if (existingToast) {
      existingToast.remove();
    }
  }
}

window.addEventListener('online', () => {
  console.log('üåê Connessione ripristinata');
  aggiornaStatoConnessione();
  
  const onlineToast = document.createElement('div');
  onlineToast.innerHTML = '‚úÖ Connesso!';
  onlineToast.style.cssText = `
    position: fixed;
    bottom: 80px;
    left: 50%;
    transform: translateX(-50%);
    background: #28a745;
    color: white;
    padding: 12px 20px;
    border-radius: 10px;
    box-shadow: 0 4px 15px rgba(40, 167, 69, 0.4);
    z-index: 9999;
    animation: slideUp 0.3s ease;
  `;
  
  document.body.appendChild(onlineToast);
  setTimeout(() => onlineToast.remove(), 3000);
});

window.addEventListener('offline', () => {
  console.log('üì° Connessione persa');
  aggiornaStatoConnessione();
});

// Verifica stato iniziale
aggiornaStatoConnessione();

// ============================================
// Animazioni CSS
// ============================================

const style = document.createElement('style');
style.textContent = `
  @keyframes slideIn {
    from {
      transform: translateX(100%);
      opacity: 0;
    }
    to {
      transform: translateX(0);
      opacity: 1;
    }
  }
  
  @keyframes slideOut {
    from {
      transform: translateX(0);
      opacity: 1;
    }
    to {
      transform: translateX(100%);
      opacity: 0;
    }
  }
  
  @keyframes slideDown {
    from {
      transform: translate(-50%, -100%);
      opacity: 0;
    }
    to {
      transform: translate(-50%, 0);
      opacity: 1;
    }
  }
  
  @keyframes slideUp {
    from {
      transform: translate(-50%, 100%);
      opacity: 0;
    }
    to {
      transform: translate(-50%, 0);
      opacity: 1;
    }
  }
`;
document.head.appendChild(style);

</script>

</body>
</html>
